{"version":3,"sources":["webpack:///D:/workspaces/hbuilder/uiapp/car-lamp/cool/ui/components/form/form.vue?ccac","webpack:///D:/workspaces/hbuilder/uiapp/car-lamp/cool/ui/components/form/form.vue?5892","webpack:///D:/workspaces/hbuilder/uiapp/car-lamp/cool/ui/components/form/form.vue?28a5","webpack:///D:/workspaces/hbuilder/uiapp/car-lamp/cool/ui/components/form/form.vue?b359","webpack:///D:/workspaces/hbuilder/uiapp/car-lamp/cool/ui/components/form/form.vue"],"names":["componentName","props","model","type","Object","default","rules","border","Boolean","showMessage","showToast","labelWidth","String","labelPosition","validateOnValueChange","data","subscrible","rules2","watch","model2","handler","newV","oldV","publish","action","deep","val","setRules","computed","JSON","parse","stringify","isBorder","created","methods","validate","callback","validateField","keys","console","warn","i","includes","find","e","prop","validator","AsyncValidator","form","forEach","errors","fields","resetFields","flag","map","undefined","$emit","clearValidate","$nextTick","addField","item","push","removeField","findIndex","splice","k","value"],"mappings":"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","file":"cool/ui/components/form/form.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./form.vue?vue&type=template&id=0f2ea0de&\"\nvar renderjs\nimport script from \"./form.vue?vue&type=script&lang=js&\"\nexport * from \"./form.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"workspaces/hbuilder/uiapp/car-lamp/cool/ui/components/form/form.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./form.vue?vue&type=template&id=0f2ea0de&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../softwares/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./form.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n\nimport AsyncValidator from \"../../utils/async-validator\";\nimport {\n\tisArray,\n\tisObject,\n\tisString,\n\tisBoolean,\n\tisEmpty,\n\tdiffForm\n} from \"../../utils\";\n\nexport default {\n\tcomponentName: \"ClForm\",\n\n\tprops: {\n\t\tmodel: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {\n\t\t\t\treturn {};\n\t\t\t}\n\t\t},\n\t\trules: Object,\n\t\tborder: Boolean,\n\t\tshowMessage: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowToast: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tlabelWidth: {\n\t\t\ttype: String,\n\t\t\tdefault: \"150rpx\"\n\t\t},\n\t\tlabelPosition: {\n\t\t\ttype: String,\n\t\t\tdefault: \"right\"\n\t\t},\n\t\tvalidateOnValueChange: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tsubscrible: [],\n\t\t\trules2: []\n\t\t};\n\t},\n\n\twatch: {\n\t\tmodel2: {\n\t\t\thandler(newV, oldV) {\n\t\t\t\tthis.publish({\n\t\t\t\t\tprops: diffForm(newV, oldV),\n\t\t\t\t\taction: \"validate\"\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeep: true\n\t\t},\n\n\t\trules(val) {\n\t\t\tthis.setRules(val);\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tmodel2() {\n\t\t\treturn JSON.parse(JSON.stringify(this.model));\n\t\t},\n\n\t\tisBorder() {\n\t\t\treturn this.border ? \"cl-form--border\" : \"\";\n\t\t}\n\t},\n\n\tcreated() {\n\t\tthis.setRules(this.rules);\n\t},\n\n\tmethods: {\n\t\t// 弥补 props 方法不能传递的问题\n\t\tsetRules(rules) {\n\t\t\tthis.rules2 = rules || {};\n\t\t},\n\n\t\t// 校验表单\n\t\tvalidate(callback) {\n\t\t\tthis.validateField(Object.keys(this.model), callback);\n\t\t},\n\n\t\t// 根据字段校验表单\n\t\tvalidateField(props, callback) {\n\t\t\tif (!props) {\n\t\t\t\tconsole.warn(`Props 为空`);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!isArray(props)) {\n\t\t\t\tprops = [props];\n\t\t\t}\n\n\t\t\tlet rules = {};\n\n\t\t\tfor (let i in this.rules2) {\n\t\t\t\tif (props.includes(i)) {\n\t\t\t\t\tif (this.subscrible.find(e => e.prop == i)) {\n\t\t\t\t\t\trules[i] = this.rules2[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst validator = new AsyncValidator(rules);\n\n\t\t\tlet form = {};\n\n\t\t\tprops.forEach(e => {\n\t\t\t\tform[e] = this.model[e];\n\t\t\t});\n\n\t\t\tvalidator.validate(form, (errors, fields) => {\n\t\t\t\tthis.publish({ props, action: \"validate\" });\n\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback(!errors, errors);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t// 重置表单\n\t\tresetFields() {\n\t\t\tlet form = {};\n\t\t\tlet flag = false;\n\n\t\t\tfor (let i in this.model) {\n\t\t\t\tlet val = this.model[i];\n\n\t\t\t\tif (val) {\n\t\t\t\t\tflag = true;\n\t\t\t\t}\n\n\t\t\t\tif (isArray(val)) {\n\t\t\t\t\tform[i] = val.map(() => null);\n\t\t\t\t} else if (isObject(val)) {\n\t\t\t\t\tform[i] = {};\n\t\t\t\t} else if (isString(val)) {\n\t\t\t\t\tform[i] = \"\";\n\t\t\t\t} else if (isBoolean(val)) {\n\t\t\t\t\tform[i] = false;\n\t\t\t\t} else {\n\t\t\t\t\tform[i] = undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (flag) {\n\t\t\t\tthis.$emit(\"update:model\", form);\n\t\t\t}\n\n\t\t\tthis.clearValidate();\n\t\t},\n\n\t\t// 移除表单校验结果\n\t\tclearValidate(props) {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.publish({ props, action: \"clear\" });\n\t\t\t});\n\t\t},\n\n\t\t// 添加字段，监听事件\n\t\taddField(prop, callback) {\n\t\t\tlet item = this.subscrible.find(e => e.prop == prop);\n\n\t\t\tif (item) {\n\t\t\t\titem.handler = callback;\n\t\t\t} else {\n\t\t\t\tthis.subscrible.push({\n\t\t\t\t\tprop,\n\t\t\t\t\thandler: callback\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t// 移除字段和事件\n\t\tremoveField(prop) {\n\t\t\tconst i = this.subscrible.findIndex(e => e.prop == prop);\n\t\t\tthis.subscrible.splice(i, 1);\n\t\t},\n\n\t\t// 发布消息\n\t\tpublish({ action, props }) {\n\t\t\tlet item = null;\n\n\t\t\tif (!props) {\n\t\t\t\tprops = Object.keys(this.model);\n\t\t\t}\n\n\t\t\tprops.forEach(k => {\n\t\t\t\titem = this.subscrible.find(e => e.prop == k);\n\n\t\t\t\tif (item) {\n\t\t\t\t\titem.handler({ action, value: this.model[k] });\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n};\n"],"sourceRoot":""}